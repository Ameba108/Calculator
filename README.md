# Распределённый вычислитель арифметических выражений
Как это работает?

Оркестратор принимает на вход выражение (например 2+2 * 2) и разбивает его на подзадачи (то есть 2 + и результат умножения 2*2). Агент в это время "просит" от оркестратора задачу и когда получает ее, выдает результат и снова просит задачу.
В дирректории calculator находится сама функция калькулятора, благодаря которой происходят все расчеты.

Перед тем, как пользователь будет делать запрос, ему нужно будет зарегестрироваться (логин и пароль). Данные пользователя будут хранится в базе данных. 

После использования калькулятора, само выражение, его статус и его ответ будут также хранится в базе данных.

Установка:
1. `git clone https://github.com/Ameba108/Calculator`
2. `cd Calculator`

Запуск:

Чтобы запустить калькулятор, нужно запустить оркестратор, агент и сам калькулятор. 
1. Запуск оркестратора:
   
   `cd orchestrator`
   
   `go run .`
3. Запуск агента:
   
   `cd agent`
   
   `go run .`
5. Запуск калькулятора:
   
   `cd internal/calculator`
   
   `go run .`

# Примеры 
Вот пример post-запросов (лучше всего запросы делать через postman):
1. Регистрация

`curl -X POST http://localhost:8080/api/v1/register -H "Content-Type: application/json" -d "{\"login\": \"<логин>\", \"password\": \"<пароль>\"}"`

![Снимок экрана 2025-05-11 164001](https://github.com/user-attachments/assets/0d7c1d38-df77-43d0-a7c7-451d715426b6)

В ответе пользователь получает OK, если регистрация проходит успешно

2. Авторизация

`curl -X POST http://localhost:8080/api/v1/login -H "Content-Type: application/json" -d "{\"login\": \"<логин>\", \"<пароль>\": \"1234\"}"`

![Снимок экрана 2025-05-11 164042](https://github.com/user-attachments/assets/7b984228-9e5c-4913-87da-825632ce5a2d)

В ответ пользователь получает токен, который нужен ему для отправления запросов в калькулятор

3. Отправить выражение калькулятору

В заголовок обязательно ставится токен юзера, иначе калькулятор не примет выражение!

`curl -X POST http://localhost:8080/api/v1/calculate -H "Content-Type: application/json" -H "Authorization: <токен>" -d "{\"expression\":  \"выражение\"}"`

![Снимок экрана 2025-05-11 164229](https://github.com/user-attachments/assets/db5c1c0b-a5c5-4cc4-897d-b51dff24ec85)

В ответе будет id выражения. Оно нужно, чтобы посмотреть результат этого выражения

Get-запросы

Во всех get-запросах не забудьте использовать ткоен юзера в заголовке!

1. Получение результата определенного выражения

`curl -X POST http://localhost:8080/api/v1/expressions/<id> -H "Content-Type: application/json" -H "Authorization: <токен>"`

![Снимок экрана 2025-05-11 164451](https://github.com/user-attachments/assets/706b0cea-f1e7-4b39-af77-871e69a11f9f)

2. Получение списка запросов

`curl -X POST http://localhost:8080/api/v1/expressions -H "Content-Type: application/json" -H "Authorization: <токен>"`

![Снимок экрана 2025-05-11 164416](https://github.com/user-attachments/assets/bd9a884b-2736-45f0-8d2d-6ad48d5dfe4f)

В случае, если пользователь отправляет выражение с неизвестными символами или с делением на ноль, в терминале будет прописываться текст ошибки, а само выражение не будет сохранться в базе данных
